{% extends "base.html" %}

{% block title %}Patients - CareAtlas Ops{% endblock %}

{% block breadcrumbs %}
<li>Patients</li>
{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Page Header -->
    <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold">Patients</h1>
        <a href="{% url 'patient_create' %}" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
            Add Patient
        </a>
    </div>

    <!-- Filters -->
    <div class="card bg-base-100 shadow">
        <div class="card-body py-4">
            <form class="flex flex-wrap gap-4 items-end">
                <div class="form-control flex-1 min-w-[200px]">
                    <label class="label">
                        <span class="label-text">Search</span>
                    </label>
                    <input type="text"
                           name="q"
                           value="{{ query }}"
                           placeholder="Search by MRN, name, or email..."
                           class="input input-bordered w-full"
                           hx-get="{% url 'patient_list' %}"
                           hx-trigger="keyup changed delay:300ms"
                           hx-target="#patient-list"
                           hx-swap="innerHTML"
                           hx-include="[name='status'], [name='program']"
                           hx-push-url="true" />
                </div>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">Status</span>
                    </label>
                    <select name="status"
                            class="select select-bordered"
                            hx-get="{% url 'patient_list' %}"
                            hx-trigger="change"
                            hx-target="#patient-list"
                            hx-include="[name='q'], [name='program']"
                            hx-push-url="true">
                        <option value="">All</option>
                        <option value="active" {% if current_status == 'active' %}selected{% endif %}>Active</option>
                        <option value="inactive" {% if current_status == 'inactive' %}selected{% endif %}>Inactive</option>
                    </select>
                </div>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text">Program</span>
                    </label>
                    <select name="program"
                            class="select select-bordered"
                            hx-get="{% url 'patient_list' %}"
                            hx-trigger="change"
                            hx-target="#patient-list"
                            hx-include="[name='q'], [name='status']"
                            hx-push-url="true">
                        <option value="">All</option>
                        <option value="RPM">RPM</option>
                        <option value="CCM">CCM</option>
                        <option value="RTM">RTM</option>
                    </select>
                </div>
            </form>
        </div>
    </div>

    <!-- Patient List -->
    <div id="patient-list">
        {% include "patients/partials/patient_table.html" %}
    </div>
</div>
{% endblock %}
